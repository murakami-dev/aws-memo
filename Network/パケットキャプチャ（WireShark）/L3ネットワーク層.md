# IPの概要
- IPパケットフォーマット
<img width="472" alt="スクリーンショット 2020-11-03 7 41 58" src="https://user-images.githubusercontent.com/60077121/97927292-117c4480-1da8-11eb-9b78-08da77f48629.png">

- バージョン：4,6
- ヘッダー長(32bit単位で表す)
  - IPヘッダーの長さを表す4ビットのフィールド。IPヘッダは基本２０バイト(160bit)なので160/32=5が一般的
  <img width="507" alt="スクリーンショット 2020-11-03 7 51 22" src="https://user-images.githubusercontent.com/60077121/97927972-61a7d680-1da9-11eb-9055-8582633ec731.png">

- ToS(type of service)
  - IPの優先度を決定する`IPプレシデンス``DSCP(Diffserv code Point)`からなる。DSCP値で決まる。
    - IPプレシデンスはToSの先頭3ビット（１０進数で0-7）。値が大きいほど優先。ユーザー定義できるのは0-5
    - DSCPは先頭6bitの64段階だが、ルータごとの転送動作（PHB,per hop behavior)で決まっている。
      - `EF`:絶対優先。VoIPなど。DSCPは46固定、IPプレシデンスは5
      - `AF`:優先的。
      - `CS`:DSCPを認識できない端末のためのPHB
      - `デフォルト`:ベストエフォート。全てのbitが0
  - Wiresharkでは`Differentiated Service Field`と表示される
  <img width="469" alt="スクリーンショット 2020-11-03 8 33 00" src="https://user-images.githubusercontent.com/60077121/97930642-31fbcd00-1daf-11eb-9d3a-61a8d72a5695.png">

- パケット長
  - IPヘッダとIPペイロードを合わせたパケット全体を表す16bit。どこまでがIPパケットなのかを知るために使用
  - 例：イーサネットのデフォルトのMTUいっぱいのIPパケットの場合、パケット長は1500
  
- 識別子
  - パケット分割（フラグメントするという）したとき各パケットに割り振る16bitの識別子。同じパケットなら同じ識別子がつく。
- フラグ
  - 1bit目は使用せず
  - 2bit目は`DF bit`(Don't Fragment)で、0ならフラグメントを許可、1なら許可しない。
  - 3bit目は`MF bit`(More Fragment)で0ならパケットが後ろに続かない、1なら続く
- フラグメントオフセット
  - そのパケットが全体のどこに位置しているか、1500バイトを976バイトで分割したら、1つめは0,2つめのパケットのフラグメントオフセットは976が入る。
- TTL
  - hopするたび減る。IPパケットが`ルーティングループ`することはない。一方でイーサネットにはこれがないので`ブリッジんグループ`は止まらない。
- プロトコル
  - 1はICMP,6TCP,17UDP
- ヘッダーチェックサム
  - データの整合性のチェック

# Wiresharkの機能
