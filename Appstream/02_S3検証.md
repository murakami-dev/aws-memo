# ネット経由ではなくS3経由でアプリをおとす
AppStream2.0 インターネット経由でインストールできないアプリをS3経由でインストールする
https://dev.classmethod.jp/articles/appstream2-install-from-s3/　　

## S3にアプリの実行ファイルを保存しておく
![image](https://user-images.githubusercontent.com/60077121/94649008-bbdaf500-032e-11eb-9d3f-5a4a8db0dbbb.png)

## VPCエンドポイントの作成
インバウンドをSWXのVPNに制限  
https://docs.aws.amazon.com/ja_jp/appstream2/latest/developerguide/creating-streaming-from-interface-vpc-endpoints.html
![image](https://user-images.githubusercontent.com/60077121/94648628-e5dfe780-032d-11eb-8902-9d8f0c40884a.png)


## IAMロールの作成（イメージビルダーインスタンスに付与）
https://docs.aws.amazon.com/ja_jp/appstream2/latest/developerguide/using-iam-roles-to-grant-permissions-to-applications-scripts-streaming-instances.html
![image](https://user-images.githubusercontent.com/60077121/94648873-6dc5f180-032e-11eb-8fcc-11e252e22f5b.png)
```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::appstream-20200930/*"
        }
    ]
}
```

## イメージビルダーインスタンスの作成
- 上記で作成したVPCエンドポイント、IAMロールを指定
- イメージビルダーインスタンスのENIはプライベートサブネットに配置。インターネットアクセスは有効化せず、NATGWから外に出るように設定

